let targetDate=new Date("2024-05-13T00:00:00");const maxBounceSpeed=2e3;let maxBouncingDays;const currentDate=new Date;let bounceSpeed=100,overLoad=!1,pauseTracker,bouncingDates=[],bouncingDatesContainer,countdownInterval,countUnits=0;const timeUnits={dayUnits:"days",weekUnits:"weeks",monthUnits:"months"},urlParams={month:"month",pickDate:"pickDate",maxBounce:"maxBounce"};let bouncingUnits=timeUnits.dayUnits,pickDateVal=getUrlParameter(urlParams.pickDate),datePickerIsShowing=!0;const speedIncrements={slow:25,increase:25},holidays={thnksgvg:"thanksgiving",chr:"christmas",ny:"newyears",val:"valentines",easter:"easter",freedom:"freedom",wed:"wed"};let buttonClickSeries=[];function setTimeUnitBtnCounters(){let e=document.getElementById("daysCounter"),t=document.getElementById("weeksCounter"),n=document.getElementById("monthsCounter");e.textContent=countUnits,t.textContent=countUnits,n.textContent=countUnits,bouncingUnits==timeUnits.dayUnits?(showElement(e.id),hideElement(t.id),hideElement(n.id)):bouncingUnits==timeUnits.weekUnits?(showElement(t.id),hideElement(e.id),hideElement(n.id)):bouncingUnits==timeUnits.monthUnits&&(showElement(n.id),hideElement(e.id),hideElement(t.id))}function setCountDown(){clearInterval(countdownInterval),countdownInterval=setInterval(updateCountdown,250)}function updateCountdown(){let e=targetDate-new Date;if(e<=0){document.querySelector(".countdown").textContent="00:00:00:00",clearInterval(countdownInterval);return}document.getElementById("days").textContent=Math.floor(e/864e5).toString().padStart(2,"0"),document.getElementById("hours").textContent=Math.floor(e%864e5/36e5).toString().padStart(2,"0"),document.getElementById("minutes").textContent=Math.floor(e%36e5/6e4).toString().padStart(2,"0"),document.getElementById("seconds").textContent=Math.floor(e%6e4/1e3).toString().padStart(2,"0")}function createBouncingDates(){let e=targetDate-currentDate;if(e<=0)return;let t=document.createDocumentFragment();!function n(){if(bouncingDates.length>=maxBouncingDays)return;let o;if(bouncingUnits===timeUnits.dayUnits){let i=Math.floor(e/864e5);if(countUnits=i,bouncingDates.length>=i)return;let a=new Date(currentDate);a.setDate(currentDate.getDate()+bouncingDates.length+1),o=`${a.getMonth()+1}/${a.getDate()}/${a.getFullYear().toString().slice(-2)}`}else if(bouncingUnits===timeUnits.monthUnits){let s=Math.floor(e/2592e6);if(countUnits=s,bouncingDates.length>=s)return;let r=new Date(currentDate);r.setMonth(currentDate.getMonth()+bouncingDates.length+1),o=(r.getMonth()+1).toString()}else if(bouncingUnits===timeUnits.weekUnits){let l=Math.floor(e/6048e5);if(countUnits=l,bouncingDates.length>=l)return;let d=new Date(currentDate);d.setDate(currentDate.getDate()+7*bouncingDates.length);let c=new Date(d);c.setDate(d.getDate()+6),o=`${d.getMonth()+1}/${d.getDate()}-${c.getMonth()+1}/${c.getDate()}/${c.getFullYear()}`}let u=document.createElement("span");u.className="bounce",u.textContent=o;let g={element:u,x:randomIntFromInterval(0,bouncingDatesContainer.offsetWidth-u.offsetWidth),y:randomIntFromInterval(0,bouncingDatesContainer.offsetHeight-u.offsetHeight),angle:Math.random()*Math.PI*2};u.style.left=`${g.x}px`,u.style.top=`${g.y}px`,bouncingDates.push(g),t.appendChild(u),n()}(),bouncingDatesContainer.appendChild(t),addQtyClass(bouncingDates.length)}function addQtyClass(e){if(e<10&&"weeks"!=bouncingUnits)for(let t of document.querySelectorAll(".bounce"))t.classList.add("small-amount"),t.style.width="40px";else if(e<70)for(let n of document.querySelectorAll(".bounce"))n.classList.add("med-amount")}function startBounceAnimation(e){let t=null;function n(o){t||(t=o);let i=o-t;t=o;let a=e.x,s=e.y;a+=Math.cos(e.angle)*bounceSpeed*i/1e3,s+=Math.sin(e.angle)*bounceSpeed*i/1e3;let r=document.querySelector(".bouncing-unit-buttons"),l=window.getComputedStyle(r).width.replace("px",""),d=bouncingDatesContainer.offsetWidth-l,c=bouncingDatesContainer.offsetHeight-e.element.offsetHeight-40;(a<1||a>d)&&(e.angle=Math.PI-e.angle),(s<1||s>c)&&(e.angle=-e.angle),a=Math.max(1,Math.min(d,a)),s=Math.max(1,Math.min(c,s)),e.element.style.left=`${a}px`,e.element.style.top=`${s}px`,e.x=a,e.y=s,requestAnimationFrame(n)}requestAnimationFrame(n)}function setDatePickerHandler(){let e=document.querySelectorAll(".date-picker");function t(){let e=this.value;targetDate=new Date(`${e}T00:00:00`),updateBouncingDates()}e.forEach(e=>{e.addEventListener("change",t)})}function setDatePickerMin(){let e=formattedNow(),t=dateAddition("day",1,e);console.log(document.getElementById("datePicker")),document.getElementById("datePicker").setAttribute("min",t)}function updateBouncingDates(){bouncingDates.forEach(e=>{let t=e.element.parentElement;t&&t.removeChild(e.element)}),bouncingDates=[],countUnits=0,createBouncingDates(),bouncingDates.forEach(e=>{startBounceAnimation(e)}),setTimeUnitBtnCounters()}function setBtnHandlers(){let e=document.getElementById("speedUpBtn"),t=document.getElementById("slowDownBtn"),n=document.getElementById("pauseBtn"),o=document.getElementById("dayUnitBtn"),i=document.getElementById("weekUnitBtn"),a=document.getElementById("monthUnitBtn"),s=document.getElementById("datePickerBtn"),r=document.getElementById("holidaySelector"),l,d,c=0,u={speedUp:!1,slowDown:!1,pause:!1};function g(){u.speedUp||(u.speedUp=!0,l=setInterval(function(){bounceSpeed<2e3&&(bounceSpeed+=speedIncrements.increase)},100))}function $(){u.slowDown||(u.slowDown=!0,d=setInterval(function(){bounceSpeed>0?bounceSpeed-=speedIncrements.slow:(document.querySelector("body").classList.add("spin-joke"),bounceSpeed=0)},100))}function h(){u.pause||(0!==bounceSpeed?(c=bounceSpeed,bounceSpeed=0):bounceSpeed=c)}function m(){clearInterval(l),clearInterval(d),u.speedUp=!1,u.slowDown=!1,bounceSpeed>=2e3&&(showJokeOverload(),setTimeout(function(){hideJokeOverload()},6e3),bounceSpeed=2e3)}e.addEventListener("mousedown",g),e.addEventListener("touchstart",function(e){e.preventDefault(),g()}),e.addEventListener("mouseup",m),e.addEventListener("touchend",m),t.addEventListener("mousedown",$),t.addEventListener("touchstart",function(e){e.preventDefault(),$()}),t.addEventListener("mouseup",m),t.addEventListener("touchend",m),n.addEventListener("click",h),n.addEventListener("touchstart",function(e){e.preventDefault(),h()}),o.addEventListener("click",function(){bouncingUnits!=timeUnits.dayUnits&&(bouncingUnits=timeUnits.dayUnits,updateBouncingDates(),setTimeUnitBtnCounters())}),i.addEventListener("click",function(){bouncingUnits!=timeUnits.weekUnits&&(bouncingUnits=timeUnits.weekUnits,updateBouncingDates(),setTimeUnitBtnCounters())}),a.addEventListener("click",function(){bouncingUnits!=timeUnits.monthUnits&&(bouncingUnits=timeUnits.monthUnits,updateBouncingDates(),setTimeUnitBtnCounters())}),s.addEventListener("click",handleShowDayPickerClick),s.addEventListener("touchstart",function(e){e.preventDefault(),handleShowDayPickerClick()}),r.addEventListener("change",function(){let e=r.value;setHoliday(holidays[e])}),r.addEventListener("touchstart",function(e){})}function handleShowDayPickerClick(){!1==datePickerIsShowing?(showDatePicker(),datePickerIsShowing=!0):!0==datePickerIsShowing&&(showDatePicker(),datePickerIsShowing=!1)}function setHoliday(e){let t={[holidays.thnksgvg]:{month:10},[holidays.chr]:{month:11,day:25},[holidays.ny]:{month:0,day:1},[holidays.val]:{month:1,day:14},[holidays.easter]:{month:3},[holidays.freedom]:null,[holidays.wed]:{month:11,day:8,year:2024}},n=null;if(e===holidays.thnksgvg)n=getThanksgiving(new Date(currentDate.getFullYear(),t[e].month,1));else if(e===holidays.easter)n=getEaster(currentDate.getFullYear(),holidays.easter.month);else if(e===holidays.freedom)n=new Date("2024-05-13T00:00:00");else if(e==holidays.wed)n=new Date(Date.UTC(t[e].year,t[e].month,t[e].day+1));else if(t[e])for(n=new Date(currentDate.getFullYear(),t[e].month,t[e].day+1);datePassed(n);)n.setFullYear(n.getFullYear()+1);n&&(targetDate=n.setDate(n.getDate()-1)),updateBouncingDates()}function getThanksgiving(e){for(e.setDate(1);4!==e.getDay();)e.setDate(e.getDate()+1);return(e.setDate(e.getDate()+22),datePassed(e))?(e.setFullYear(e.getFullYear()+1),getThanksgiving(e)):(console.log(e),e)}function getEaster(e){let t=e%19,n=Math.floor(e/100),o=e%100,i=(19*t+n-Math.floor(n/4)-Math.floor((n-Math.floor((n+8)/25)+1)/3)+15)%30,a=(32+2*(n%4)+2*Math.floor(o/4)-i-o%4)%7,s=i+a-7*Math.floor((t+11*i+22*a)/451)+114,r=new Date(e,Math.floor(s/31)-1,s%31+2);for(;datePassed(r);)r=getEaster(r.getFullYear()+1);return r}function datePassed(e){return e<currentDate}function changeBouncingUnit(e){bouncingUnits=e}function showJokeOverload(){let e=document.body;if(!e){console.error("The body element does not exist.");return}e.classList.add("overload");let t=document.createElement("style");t.type="text/css",t.id="overloadStyle",t.textContent="body.overload { background: white !important; }",document.head.appendChild(t);let n=document.querySelectorAll("body.overload > *");n.forEach(e=>{e.style.display="none"});let o=getFakeCrashDiv(),i=document.querySelector(".overload");i?i.appendChild(o):console.error("Could not find 'body.overload' for appending the fake crash div."),setTimeout(function(){o?o.innerHTML+="<div style='font-size: x-large' id='timedNote'>Just Kidding &#128540;</div>":console.error("Fake crash div is missing.")},3e3),overLoad=!0}function hideJokeOverload(){let e=document.querySelectorAll("body.overload > *");e.forEach(e=>{e.style.display=""}),document.body.classList.remove("overload");let t=document.getElementById("overloadStyle");t&&t.remove();let n=document.getElementById("crashDiv");n&&n.remove();let o=document.getElementById("timedNote");o&&o.remove()}function getFakeCrashDiv(){let e=document.createElement("div");return e.id="crashDiv",e.textContent="{fatal error: 720, webserver has crashed. Contact the admin for further assistance}",e}function showDatePicker(){if(!1==datePickerIsShowing||pickDateVal)datePicker.classList.remove("hidden"),setDatePickerMin(),setDatePickerHandler();else{let e=document.getElementById("datePicker");e&&e.classList.add("hidden")}}function setMaxBouncing(){let e=getUrlParameter(urlParams.maxBounce);e?(e<500||e>0)&&(maxBouncingDays=parseInt(e)):maxBouncingDays=100}function setHandleResizeEvent(){window.addEventListener("resize",handleResize)}document.addEventListener("DOMContentLoaded",function(){setBtnHandlers(),showDatePicker(),setMaxBouncing(),setHandleResizeEvent(),handleResize(),bouncingDatesContainer=document.querySelector(".bouncing-dates"),setCountDown(),createBouncingDates(),setTimeUnitBtnCounters(),setTheme(),bouncingDates.forEach(e=>{startBounceAnimation(e)})});