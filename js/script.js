let targetDate=new Date("2024-05-13T00:00:00");const maxBounceSpeed=2e3;let maxBouncingDays;const currentDate=new Date;let pauseTracker,bouncingDatesContainer,countdownInterval,bounceSpeed=100,overLoad=!1,bouncingDates=[],countUnits=0;const timeUnits={dayUnits:"days",weekUnits:"weeks",monthUnits:"months"},urlParams={month:"month",pickDate:"pickDate",maxBounce:"maxBounce"};let bouncingUnits=timeUnits.dayUnits,pickDateVal=getUrlParameter(urlParams.pickDate),datePickerIsShowing=!0;const speedIncrements={slow:25,increase:25},holidays={thnksgvg:"thanksgiving",chr:"christmas",ny:"newyears",val:"valentines",easter:"easter",freedom:"freedom"};let buttonClickSeries=[];function setTimeUnitBtnCounters(){const e=document.getElementById("daysCounter"),t=document.getElementById("weeksCounter"),n=document.getElementById("monthsCounter");e.textContent=countUnits,t.textContent=countUnits,n.textContent=countUnits,bouncingUnits==timeUnits.dayUnits?(showElement(e.id),hideElement(t.id),hideElement(n.id)):bouncingUnits==timeUnits.weekUnits?(showElement(t.id),hideElement(e.id),hideElement(n.id)):bouncingUnits==timeUnits.monthUnits&&(showElement(n.id),hideElement(e.id),hideElement(t.id))}function setCountDown(){clearInterval(countdownInterval),countdownInterval=setInterval(updateCountdown,250)}function updateCountdown(){const e=targetDate-new Date;if(e<=0)return document.querySelector(".countdown").textContent="00:00:00:00",void clearInterval(countdownInterval);const t=Math.floor(e/864e5),n=Math.floor(e%864e5/36e5),o=Math.floor(e%36e5/6e4),a=Math.floor(e%6e4/1e3);document.getElementById("days").textContent=t.toString().padStart(2,"0"),document.getElementById("hours").textContent=n.toString().padStart(2,"0"),document.getElementById("minutes").textContent=o.toString().padStart(2,"0"),document.getElementById("seconds").textContent=a.toString().padStart(2,"0")}function createBouncingDates(){const e=targetDate-currentDate;if(e<=0)return;const t=document.createDocumentFragment();!function n(){if(bouncingDates.length>=maxBouncingDays)return;let o;if(bouncingUnits===timeUnits.dayUnits){const t=Math.floor(e/864e5);if(countUnits=t,bouncingDates.length>=t)return;const n=new Date(currentDate);n.setDate(currentDate.getDate()+bouncingDates.length+1),o=`${n.getMonth()+1}/${n.getDate()}/${n.getFullYear().toString().slice(-2)}`}else if(bouncingUnits===timeUnits.monthUnits){const t=Math.floor(e/2592e6);if(countUnits=t,bouncingDates.length>=t)return;const n=new Date(currentDate);n.setMonth(currentDate.getMonth()+bouncingDates.length+1),o=(n.getMonth()+1).toString()}else if(bouncingUnits===timeUnits.weekUnits){const t=Math.floor(e/6048e5);if(countUnits=t,bouncingDates.length>=t)return;const n=new Date(currentDate);n.setDate(currentDate.getDate()+7*bouncingDates.length);const a=new Date(n);a.setDate(n.getDate()+6),o=`${n.getMonth()+1}/${n.getDate()}-${a.getMonth()+1}/${a.getDate()}/${a.getFullYear()}`}const a=document.createElement("span");a.className="bounce",a.textContent=o;let i={element:a,x:randomIntFromInterval(0,bouncingDatesContainer.offsetWidth-a.offsetWidth),y:randomIntFromInterval(0,bouncingDatesContainer.offsetHeight-a.offsetHeight),angle:Math.random()*Math.PI*2};a.style.left=`${i.x}px`,a.style.top=`${i.y}px`,bouncingDates.push(i),t.appendChild(a),n()}(),bouncingDatesContainer.appendChild(t),addQtyClass(bouncingDates.length)}function addQtyClass(e){if(e<10&&"weeks"!=bouncingUnits)for(const e of document.querySelectorAll(".bounce"))e.classList.add("small-amount"),e.style.width="40px";else if(e<70)for(const e of document.querySelectorAll(".bounce"))e.classList.add("med-amount")}function startBounceAnimation(e){let t=null;requestAnimationFrame((function n(o){t||(t=o);const a=o-t;t=o;let i=e.x,s=e.y;i+=Math.cos(e.angle)*bounceSpeed*a/1e3,s+=Math.sin(e.angle)*bounceSpeed*a/1e3;let c=document.querySelector(".bouncing-unit-buttons"),d=window.getComputedStyle(c).width.replace("px","");const r=bouncingDatesContainer.offsetWidth-d,u=bouncingDatesContainer.offsetHeight-e.element.offsetHeight-40;(i<1||i>r)&&(e.angle=Math.PI-e.angle),(s<1||s>u)&&(e.angle=-e.angle),i=Math.max(1,Math.min(r,i)),s=Math.max(1,Math.min(u,s)),e.element.style.left=`${i}px`,e.element.style.top=`${s}px`,e.x=i,e.y=s,requestAnimationFrame(n)}))}function setDatePickerHandler(){function e(){const e=this.value;targetDate=new Date(`${e}T00:00:00`),updateBouncingDates()}document.querySelectorAll(".date-picker").forEach((t=>{t.addEventListener("change",e)}))}function setDatePickerMin(){let e=formattedNow(),t=dateAddition("day",1,e);console.log(document.getElementById("datePicker")),document.getElementById("datePicker").setAttribute("min",t)}function updateBouncingDates(){bouncingDates.forEach((e=>{const t=e.element.parentElement;t&&t.removeChild(e.element)})),bouncingDates=[],countUnits=0,createBouncingDates(),bouncingDates.forEach((e=>{startBounceAnimation(e)})),setTimeUnitBtnCounters()}function setBtnHandlers(){const e=document.getElementById("speedUpBtn"),t=document.getElementById("slowDownBtn"),n=document.getElementById("pauseBtn"),o=document.getElementById("dayUnitBtn"),a=document.getElementById("weekUnitBtn"),i=document.getElementById("monthUnitBtn"),s=document.getElementById("datePickerBtn"),c=document.getElementById("holidaySelector");let d,r,u=0,l={speedUp:!1,slowDown:!1,pause:!1};function g(){l.speedUp||(l.speedUp=!0,d=setInterval((function(){bounceSpeed<2e3&&(bounceSpeed+=speedIncrements.increase)}),100))}function m(){l.slowDown||(l.slowDown=!0,r=setInterval((function(){bounceSpeed>0?bounceSpeed-=speedIncrements.slow:(document.querySelector("body").classList.add("spin-joke"),bounceSpeed=0)}),100))}function h(){l.pause||(0!==bounceSpeed?(u=bounceSpeed,bounceSpeed=0):bounceSpeed=u)}function D(){clearInterval(d),clearInterval(r),l.speedUp=!1,l.slowDown=!1,bounceSpeed>=2e3&&(showJokeOverload(),setTimeout((function(){hideJokeOverload()}),6e3),bounceSpeed=2e3)}e.addEventListener("mousedown",g),e.addEventListener("touchstart",(function(e){e.preventDefault(),g()})),e.addEventListener("mouseup",D),e.addEventListener("touchend",D),t.addEventListener("mousedown",m),t.addEventListener("touchstart",(function(e){e.preventDefault(),m()})),t.addEventListener("mouseup",D),t.addEventListener("touchend",D),n.addEventListener("click",h),n.addEventListener("touchstart",(function(e){e.preventDefault(),h()})),o.addEventListener("click",(function(){bouncingUnits!=timeUnits.dayUnits&&(bouncingUnits=timeUnits.dayUnits,updateBouncingDates(),setTimeUnitBtnCounters())})),a.addEventListener("click",(function(){bouncingUnits!=timeUnits.weekUnits&&(bouncingUnits=timeUnits.weekUnits,updateBouncingDates(),setTimeUnitBtnCounters())})),i.addEventListener("click",(function(){bouncingUnits!=timeUnits.monthUnits&&(bouncingUnits=timeUnits.monthUnits,updateBouncingDates(),setTimeUnitBtnCounters())})),s.addEventListener("click",handleShowDayPickerClick),s.addEventListener("touchstart",(function(e){e.preventDefault(),handleShowDayPickerClick()})),c.addEventListener("change",(function(){const e=c.value;setHoliday(holidays[e])})),c.addEventListener("touchstart",(function(e){}))}function handleShowDayPickerClick(){0==datePickerIsShowing?(showDatePicker(),datePickerIsShowing=!0):1==datePickerIsShowing&&(showDatePicker(),datePickerIsShowing=!1)}function setHoliday(e){const t={[holidays.thnksgvg]:{month:10},[holidays.chr]:{month:11,day:25},[holidays.ny]:{month:0,day:1},[holidays.val]:{month:1,day:14},[holidays.easter]:{month:3},[holidays.freedom]:null};let n=null;if(e===holidays.thnksgvg)n=getThanksgiving(t[e].month);else if(e===holidays.easter)n=getEaster(currentDate.getFullYear(),holidays.easter.month);else if(e===holidays.freedom)n=new Date("2024-05-13T00:00:00");else if(t[e])for(n=new Date(currentDate.getFullYear(),t[e].month,t[e].day+1);datePassed(n);)n.setFullYear(n.getFullYear()+1);n&&(targetDate=n.setDate(n.getDate()-1)),console.log(n),updateBouncingDates()}function getThanksgiving(e){for(thanksgivingDate=new Date(currentDate.getFullYear(),e,1),thanksgivingDate.setDate(1);4!==thanksgivingDate.getDay();)thanksgivingDate.setDate(thanksgivingDate.getDate()+1);return thanksgivingDate.setDate(thanksgivingDate.getDate()+22),datePassed(thanksgivingDate)?(thanksgivingDate.setFullYear(thanksgivingDate.getFullYear()+1),getThanksgiving(thanksgivingDate)):thanksgivingDate}function getEaster(e){const t=e%19,n=Math.floor(e/100),o=e%100,a=Math.floor(n/4),i=n%4,s=Math.floor((n+8)/25),c=(19*t+n-a-Math.floor((n-s+1)/3)+15)%30,d=(32+2*i+2*Math.floor(o/4)-c-o%4)%7,r=c+d-7*Math.floor((t+11*c+22*d)/451)+114,u=Math.floor(r/31);let l=new Date(e,u-1,r%31+2);for(;datePassed(l);)l=getEaster(l.getFullYear()+1);return l}function datePassed(e){return e<currentDate}function changeBouncingUnit(e){bouncingUnits=e}function showJokeOverload(){const e=document.body;if(!e)return void console.error("The body element does not exist.");e.classList.add("overload");const t=document.createElement("style");t.type="text/css",t.id="overloadStyle",t.textContent="body.overload { background: white !important; }",document.head.appendChild(t);document.querySelectorAll("body.overload > *").forEach((e=>{e.style.display="none"}));const n=getFakeCrashDiv(),o=document.querySelector(".overload");o?o.appendChild(n):console.error("Could not find 'body.overload' for appending the fake crash div."),setTimeout((function(){n?n.innerHTML+="<div style='font-size: x-large' id='timedNote'>Just Kidding &#128540;</div>":console.error("Fake crash div is missing.")}),3e3),overLoad=!0}function hideJokeOverload(){document.querySelectorAll("body.overload > *").forEach((e=>{e.style.display=""})),document.body.classList.remove("overload");const e=document.getElementById("overloadStyle");e&&e.remove();const t=document.getElementById("crashDiv");t&&t.remove();const n=document.getElementById("timedNote");n&&n.remove()}function getFakeCrashDiv(){const e=document.createElement("div");return e.id="crashDiv",e.textContent="{fatal error: 720, webserver has crashed. Contact the admin for further assistance}",e}function showDatePicker(){if(0==datePickerIsShowing||pickDateVal)datePicker.classList.remove("hidden"),setDatePickerMin(),setDatePickerHandler();else{const e=document.getElementById("datePicker");e&&e.classList.add("hidden")}}function setMaxBouncing(){let e=getUrlParameter(urlParams.maxBounce);e?(e<500||e>0)&&(maxBouncingDays=parseInt(e)):maxBouncingDays=100}function setHandleResizeEvent(){window.addEventListener("resize",handleResize)}document.addEventListener("DOMContentLoaded",(function(){setBtnHandlers(),showDatePicker(),setMaxBouncing(),setHandleResizeEvent(),handleResize(),bouncingDatesContainer=document.querySelector(".bouncing-dates"),setCountDown(),createBouncingDates(),setTimeUnitBtnCounters(),setTheme(),bouncingDates.forEach((e=>{startBounceAnimation(e)}))}));